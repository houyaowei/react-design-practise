你好！

假设你已经知道了什么是react，并了解它解决了什么问题。你还有可能已经用react开发过中小型项目，但希望进一步提升自己的技能并得到所有未解决问题的答案。  
你应该知道，React由Facebook的开发人员和JavaScript社区中的数百位贡献者维护。  
React是最流行的UI开发库之一，因高性能而被人们熟知，这要归功于它巧妙地处理了DOM。  
React使用JSX，一种 JavaScript 的语法扩展。 这需要你重新思考\*关注点分离原则\*。react有许多很酷的特性，例如服务端渲染，该特性让你可以开发通用应用。

> 关注点分离原则，也叫正交原则，HTML CSS JS 分离, 并且互不影响状态转移：js不改css 的样式（obj.style.color='red'），只修改css中的状态（ddClass\('active'\)）。

学习本书前，你需要了解在node.js环境中，如何使用命令安装和运行npm。  
本书中所有的示例都遵循ES2015语法，便易于阅读和理解。  
在第一章里，我们将介绍一些基础概念，有助于高效地使用react，对于初学者来说理解这些概念非常重要:

* 命令式编程与声明式编程的区别
* react组件与组件实例，react如何用元素来控制UI流的。
* react如何改变构建web应用的方式，主张一种新的关注点分离的是什么样的，它选择\* 不同的设计理念背后的原因是什么。

为什么人们对javaScript框架感到疲劳，使用react生态系统时，如何避免开发者常见的错误？

#### 1.1 声明式编程

阅读react文档和博客时，你肯定遇到过_声明式_这一词汇。  
事实上，react如此强大的原因之一是它强调了声明式编程规范。  
因此，要掌握react，需要理解声明式编程的概念以及它与命令式编程的区别。  
最简单的理解方式是命令式编程描述代码如何工作，声明式编程则表明想要达到什么目的。  
现实生活中一个有关命令式编程的例子，比如去酒吧喝啤酒，对服务员发出以下指令：

* 从架子上取出一个杯子
* 把杯子放在酒瓶前
* 取下瓶塞，将被子倒满。
* 把杯子递给我

在声明式的世界里，你只需说”请给我一杯啤酒“。  
按声明式的方法点一杯啤酒，需要假设服务员知道如何提供啤酒，这是声明式编程工作的一个重要方面。  
来看一个JavaScript的示例，写一个简单的函数，传入包含大写字符串的数组，该函数返回包含相同的小写字符串的数组。

```
toLowerCase\(\['FOO', 'BAR'\]\) // \['foo', 'bar'\]
```

命令式函数按如下方式实现：

```
 const toLowerCase = input => {
   const output = [];
   for (let i = 0; i < input.length; i++) {
     output.push(input[i].toLowerCase())
   }
  return output;
 }
```

首先创建一个空数组来保存结果，通过遍历传入的数组，将数组中的每个元素转为小写存入到空数组，并返回输出该数组。  
声明式实现如下所示：

```
const toLowerCase = input => input.map(

value =&gt; value.toLowerCase()

)
```

##### 参数中的元素会传递到map函数，然后map函数会返回包含小写值的新数组。

# 

# 有一些重要的差别需要注意：前者代码不够优雅，需要更多的心思去理解。后者更简洁，也更好理解，对于大型代码库来说，可维护性是至关重要的。

# 

# 另一方面，声明式编程不需要使用变量，在执行过程中不会更新变量的值。事实上，声明式变量更倾向于避免创建和修改状态。

# 

# 最后一个示例，了解一下react声明式变量。

# 

# 我们将解决web开发中一个常见的需求：展示带有标记的地图。

# 

# JavaScript实现（使用Google Maps SDK），如下示例。

# 

# \`\`\`

# const map = new google.maps.Map\(document.getElementById\('map'\), {

# zoom: 4,

# center: myLatLng,

# }\)

# 

# const marker = new google.maps.Marker\({

# position: myLatLng,

# title: 'Hello World!',

# }\)

# marker.setMap\(map\)

# \`\`\`

# 这显然是命令式，因为在代码中描述了创建地图，创建标记，将标记放入地图中的指令。

# React组件在一个页面上展示地图的方式，如下示例：

# 

# \`\`\`

# &lt;Gmaps zoom={4} center={myLatLng}&gt;

# &lt;Marker position={myLatLng} title="Hello world!" /&gt;

# &lt;/Gmaps&gt;

# \`\`\`

# 在声明式编程中，开发者只需要描述想实现什么么不需要列出具体的步骤。

# 声明式编程方式使得React很容易使用，因此最终的代码也很简单，这样产生的bug也更少，可维护性也更强。

# 

# \#\#\#\#1.2 React元素

# 假设你已经熟悉组件及其实例，要想高效地使用react，你还需要了解另一个对象——元素。

# 

# 无论调用createClass方法，还是继承Component，或者声明一个无状态函数，都是在创建组件。React管理着运行环境中的所有组件实例，在某一时刻，内存中可能存在一个组件的多个实例。

# 

# 如前文所述，React遵循声明式规范，因此不需要告诉她如何与Dom交互。只需要声明希望在屏幕上看到什么，React就会为你完成工作。

# 

# 你可能已经体会过，大部分UI库是按相反方式工作的：让开发人员负责更新页面，手动管理DOM元素的创建和销毁。

# 

# React使用\*\*元素\*\*这种特殊类型的对象来控制UI流程。元素描述了屏幕需要显示的内容。这些不可变，对象比组件和组建实例要简单的多，只包含了展示界面所必须的信息。

# 

# 如下是一个元素的例子：

# 

# \`\`\`

# {

# type: Title,

# props: {

# color: 'red',

# children: 'Hello, Title!'

# }

# }

# \`\`\`

# 元素最重要的属性是\*\*type\*\*，和一些其他属性。另一个比较特殊的属性是\*\*children\*\*，它是可选的，表示元素的直接后代。

# 

# \*\*type\*\*属性非常重要，因为它告诉React如何处理元素本身。如果type属性是一个字符串，则表示一个\*\*DOM\*\*节点，如果是一个函数，则表示一个组件。

# 

# DOM元素和组件可以相互嵌套，以表示一个渲染树。

# 

# \`\`\`

# {

# type: Title,

# props: {

# color: 'red',

# children: {

# type: 'h1',

# props: {

# children: 'Hello, H1!'

# }

# }

# }

# }

# \`\`\`

# 当元素的type属性是一个函数时，React会调用它，传入\*\*props\*\*来取回底层元素。React对返回结果进行回调，直到得到一个完整的DOM节点树，渲染到页面。

# 

# 这个过程称作\*\*一致性比较\*\*，React DOM和ReactNative 都用它在各自的平台创建UI。

# 

# \#\#\#\#1.3 舍弃所学

# 初次使用react需要一个开发者的思想，因为它带来了设计web和app应用的新方式。实际上，React试图打破我们熟知的大部分的最佳实践，并革新UI的构建方式。

# 

# 过去的二十年，我们知道关注点分离这条原则非常重要，也习惯将其理解为从模板中分离出逻辑。我们的目标始终是将Javascript和HTML彻底离开。

# 

# 为了实现这个目标，帮助开发者，创建出不同的模板方案。

# 

# 问题在于，大多数情况下，这种分离仅仅是一种假象。真相是，无论Javascript和HTML写在什么地方，它们都是紧密耦合的。

# 

# 我们来看一个模板的示例：

# 



